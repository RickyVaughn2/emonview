<!doctype html>
    
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Emoncms</title>

        <!--<link href="static/style.css" rel="stylesheet">-->
        <link href="static/bootstrap/css/bootstrap.min.css" rel="stylesheet">
        <link href="static/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">
        
        <script type="text/javascript" src="static/jquery-1.9.0.min.js"></script>
        <script type="text/javascript" src="static/app.js"></script>
    </head>
    <body>

        <div class="navbar navbar-inverse navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <div class="nav-collapse collapse">
                        <ul class="nav">
                            <li><a href="#nodes">Nodes</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="container">

<h2>Nodes API</h2>

<table class="table">
<tr><td><b>GET /api</b></td><td></td></tr>

<tr>
    <td>
        <a href="api">/api</a>
    </td>
    <td>

<pre>
{
    "10":{
        "nodename":"House",
        "firmware":"emontx_firmware_continuous",
        "hardware":"EmonTx v3.4",
        "time":1423344776,
        "names":["power1","power2","power3"],
        "values":["100","200","300"],
        "units":["W","W","W"]
    }
}</pre>

    </td>
</tr>

<tr><td><b>GET nodes/nodeid</b></td><td></td></tr>

<tr>
    <td>
        <a href="api/10">/api/10</a>
    </td>
    <td>
    
<pre>
{
    "nodename":"House",
    "firmware":"emontx_firmware_continuous",
    "hardware":"EmonTx v3.4",
    "time":1423344776,
    "names":["power1","power2","power3"],
    "values":["100","200","300"],
    "units":["W","W","W"]
}</pre>

    </td>
</tr>

<tr>
    <td><a href="api/10/nodename">/api/10/nodename</a></td>
    <td><pre>"House"</pre></td>
</tr>
<tr>
    <td><a href="api/10/hardware">/api/10/hardware</a></td>
    <td><pre>"EmonTx v3.4"</pre></td>
</tr>
<tr>
    <td><a href="api/10/firmware">/api/10/firmware</a></td>
    <td><pre>"emontx_firmware_continuous"</pre></td>
</tr>
<tr>
    <td><a href="api/10/names">/api/10/names</a></td>
    <td><pre>["power1","power2","power3"]</pre></td>
</tr>
<tr>
    <td><a href="api/10/values">/api/10/values</a></td>
    <td><pre>[100,200,300]</pre></td>
</tr>
<tr>
    <td><a href="api/10/units">/api/10/units</a></td>
    <td><pre>["W","W","W"]</pre></td>
</tr>

<tr><td><b>GET nodes/nodeid/varid</b></td><td></td></tr>
<tr>
    <td><a href="api/10/0">/api/10/0</a></td>
    <td><pre>{"name":"power1","value":"100","unit":"W"}</pre></td>
</tr>
<tr>
    <td><a href="api/10/0/name">/api/10/0/name</a></td>
    <td><pre>"power1"</pre></td>
</tr>
<tr>
    <td><a href="api/10/0/value">/api/10/0/value</a></td>
    <td><pre>100</pre></td>
</tr>
<tr>
    <td><a href="api/10/0/unit">/api/10/0/unit</a></td>
    <td><pre>"W"</pre></td>
</tr>
<tr>
    <td><a href="api/10/0/meta">/api/10/0/meta</a></td>
    <td><pre>{"start":null,"interval":null,"npoints":0,"size":false}</pre></td>
</tr>

<tr>
    <td><a href="api/10/0/datastart=0&end=0&interval=60">/api/10/0/data?start=0&end=0&interval=60</a></td>
    <td><pre></pre></td>
</tr>


<tr><td><b>POST nodes</b></td><td></td></tr>
<tr>
    <td>/api/config</td>
    <td key="config" contentType="text/plain">
        <textarea style="width:100%; height:200px">
{
    "10":{
        "nodename":"House",
        "firmware":"emontx_firmware_continuous",
        "hardware":"EmonTx v3.4",
        "names":["power1","power2","power3"],
        "units":["W","W","W"]
    }
} 
        </textarea><br>
        <div><button class="btn ok">ok</button></div>
    </td>
</tr>
<tr>
    <td>/api/bulk</td>
    <td key="bulk" contentType="application/x-www-form-urlencoded" >
        <div class="input-append" style="width:80%">
            <input type="text" value="data=[[0,10,110,200,300],[10,10,120,200,290],[15,10,130,200,280]]&sentat=20" style="width:100%">
            <button class="btn ok">ok</button>
        </div>
    </td>
</tr>
<tr><td><b>POST nodes/nodeid</b></td><td></td></tr>
<tr>
    <td>/api/10/values</td>
    <td key="10/values" contentType="text/plain">
        <div class="input-append">
            <input type="text" value="100,200,300">
            <button class="btn ok">ok</button>
        </div>
    </td>
</tr>
<tr>
    <td>/api/10/nodename</td>
    <td key="10/nodename" contentType="text/plain">
        <div class="input-append">
            <input type="text" value="House">
            <button class="btn ok">ok</button>
        </div>
    </td>
</tr>
<tr>
    <td>/api/10/hardware</td>
    <td key="10/hardware" contentType="text/plain">
        <div class="input-append">
            <input type="text" value="EmonTx v3.4">
            <button class="btn ok">ok</button>
        </div>
    </td>
</tr>
<tr>
    <td>/api/10/firmware</td>
    <td key="10/firmware" contentType="text/plain">
        <div class="input-append">
            <input type="text" value="emontx_firmware_continuous">
            <button class="btn ok">ok</button>
        </div>
    </td>
</tr>
<tr>
    <td>/api/10/names</td>
    <td key="10/names" contentType="text/plain">
        <div class="input-append">
            <input type="text" value="power1,power2,power3">
            <button class="btn ok">ok</button>
        </div>
    </td>
</tr>
<tr>
    <td>/api/10/units</td>
    <td key="10/units" contentType="text/plain">
        <div class="input-append">
            <input type="text" value="W,W,W">
            <button class="btn ok">ok</button>
        </div>
    </td>
</tr>
<tr><td><b>POST nodes/nodeid/varid</b></td><td></td></tr>
<tr>
    <td>/api/10/0/name</td>
    <td key="10/0/name" contentType="text/plain">
        <div class="input-append">
            <input type="text" value="power1">
            <button class="btn ok">ok</button>
        </div>
    </td>
</tr>
<tr>
    <td>/api/10/0/unit</td>
    <td key="10/0/unit" contentType="text/plain">
        <div class="input-append">
            <input type="text" value="W">
            <button class="btn ok">ok</button>
        </div>
    </td>
</tr>
</table>

<script>
var path = window.location.href.replace("/test","");
console.log(path);

$(".ok").click(function(){
    var td = $(this).parent().parent();
    var key = td.attr("key");
    var contentType = td.attr("contentType");
    var value = td.find("input").val();
    if (value==undefined) {
        var value = td.find("textarea").val();
    }
    $.ajax({ 
        type: "POST",
        contentType: contentType,
        url: path + "/api/" + key,
        data: value
    });
});
</script>

        </div>

        <script src="static/bootstrap/js/bootstrap.js"></script>
    </body>
</html>

